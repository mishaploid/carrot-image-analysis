lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2])
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2])
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
main <- plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
main
plot(main)
main
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5)
par(mfrow=c(1,2))
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5)
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n")
par(mfrow=c(1,2))
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n")
plot.new()
par(mfrow=c(2,1))
par(mar=c(0, 0, 0, 0))
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n")
layout(rbind(1,2), heights=c(1,7))  # put legend on bottom 1/8th of the chart
par(mfrow=c(2,1))
par(mar=c(0, 0, 0, 0))
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n")
layout(rbind(1,2), heights=c(1,7))  # put legend on bottom 1/8th of the chart
par(mar=c(0, 0, 0, 0))
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n")
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
layout(rbind(1,2), heights=c(2,6))  # put legend on bottom 1/8th of the chart
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
dev.off()
layout(rbind(1,2), heights=c(2,6))  # put legend on bottom 1/8th of the chart
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
par(mfrow=c(2,1))
plot.new()
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
legend("center", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
legend("top", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5, bty="n", ncol=3)
legend("top", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5)
legend("left", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5)
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5)
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1.5)
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1, pt.cex=1.5)
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1, pt.cex=1.5)
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1, pt.cex=2)
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1, pt.cex=2, title.cex=2)
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1, pt.cex=2, title.cex=2)
plot(emp_h2[emp_h2$QTL=="1",]$heritability, emp_h2[emp_h2$QTL=="1",]$Detection_Rate,
type="o", lwd=4, cex=1.5, xlab="Heritability", ylab="QTL Detection Rate", cex.axis=1.25,
cex.lab=1.5, col=cbPalette[1]) +
box(lwd=4) +
lines(emp_h2[emp_h2$QTL=="2",]$heritability, emp_h2[emp_h2$QTL=="2",]$Detection_Rate,
type="o", lty=2, lwd=4, cex=1.5, col=cbPalette[2]) +
lines(emp_h2[emp_h2$QTL=="10",]$heritability, emp_h2[emp_h2$QTL=="10",]$Detection_Rate,
type="o", lty=3, lwd=4, cex=1.5, col=cbPalette[3]) +
lines(emp_h2[emp_h2$QTL=="25",]$heritability, emp_h2[emp_h2$QTL=="25",]$Detection_Rate,
type="o", lty=4, lwd=4, cex=1.5, col=cbPalette[4]) +
lines(emp_h2[emp_h2$QTL=="50",]$heritability, emp_h2[emp_h2$QTL=="50",]$Detection_Rate,
type="o", lty=5, lwd=4, cex=1.5, col=cbPalette[5]) +
lines(emp_h2[emp_h2$QTL=="100",]$heritability, emp_h2[emp_h2$QTL=="100",]$Detection_Rate,
type="o", lty=6, lwd=4, cex=1.5, col=cbPalette[7])
legend("topleft", legend=levels(emp_h2$QTL),lty=c(1:6), col=cbPalette[c(1:5,7)], bg="white",lwd=4,
title="No. QTL", cex=1, pt.cex=2)
library(ggplot2)
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line()
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line() +
geom_point()
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=2)
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4)
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4) +
theme_bw()
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4) +
scale_fill_manual(col=cbPalette) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4) +
scale_fill_manual(cbPalette) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4) +
scale_fill_manual(values=cbPalette) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, type=1:7) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, linetype=1:7) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, linetype=1:6) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, linetype=c(1:6)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, linetype=QTL) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
theme(text=element_text(size=18),
axis.title.x="Heritability",
axis.title.y="Detection Rate")
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18),
legend.title="Number of QTL")
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18),
legend.title=element.text("Number of QTL"))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18),
legend.title=element_text("Number of QTL"))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)], name="Number of QTL") +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18),
legend.title="Number of QTL")
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)], name="Number of QTL") +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
guide_legend(title="my awesome title") +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18))
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
#guide_legend(title="my awesome title") +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=18))
?ggsave
ggsave("emp_heritability.png", width=6, height=6, units="in", dpi=300)
ggsave("~/Downloads/emp_heritability.png", width=6, height=6, units="in", dpi=300)
ggsave("~/Downloads/emp_heritability.png", width=8, height=6, units="in", dpi=300)
ggplot(emp_h2, aes(heritability, Detection_Rate, col=QTL)) +
geom_line(size=2, aes(linetype=QTL)) +
geom_point(size=4) +
scale_colour_manual(values=cbPalette[c(1:5,7)]) +
#guide_legend(title="my awesome title") +
theme_bw() +
xlab("Heritability") +
ylab("Detection Rate") +
theme(text=element_text(size=20))
ggsave("~/Downloads/emp_heritability.png", width=8, height=6, units="in", dpi=300)
library(qtl)
setwd("~/Dropbox/carrot-image-analysis/qtl_mapping/data/")
topsize <- read.cross(file="input2.csv", format="csv", estimate.map=FALSE,
genotypes = c("a", "h", "b"), alleles = c("a", "b"),
na.strings = c("-", "NA"))
topsize <- jittermap(topsize)
topsize <- calc.genoprob(topsize, step = 1, map.function = "kosambi", error.prob = 0.001)
topsize <- sim.geno(topsize, step=1, map.function="kosambi", error.prob=0.001)
topsize <- calc.genoprob(topsize, step=1, error.prob=0.001, map.function="kosambi")
topsize.fill <- fill.geno(topsize, method = "argmax")
topsize.fill <- calc.genoprob(topsize.fill, step = 1, error.prob = 0.001) # recalculate genoprob
load("~/Dropbox/carrot-image-analysis/qtl_mapping/results/mqm_results.RData")
setwd("~/Dropbox/carrot-image-analysis/qtl_mapping/")
filelist <- list.files(path="./osg_results", pattern = "perm_combined*",
recursive=TRUE, full.names=TRUE)
filelist <- sort(filelist)
df_list <- lapply(filelist, function(x) source(x))
traits <- read.csv("trait_ids.csv")
names(df_list) <- traits$traits
rm(topsize)
sig.markers <- list()
for (i in 1:39){
tryCatch({
sig.markers[[i]] <- mqmfind.marker(topsize.fill, mqmscan = mqm_backw[[i]],
perm = df_list[[i]][[1]], alpha = 0.01)
}, error=function(e){cat("ERROR:", conditionMessage(e), "\n")})
}
sig.markers[[39]] <- "NULL"
sig.markers <- lapply(sig.markers, as.data.frame)
result2 <- NULL
out <- list()
for (i in 1:39){
tryCatch({
result <- mqmextractmarkers(mqm_backw[[i]])
for (j in 1:length(sig.markers[[i]]$chr)){
chr <- sig.markers[[i]]$chr[j]
lodint.result <- lodint(result, paste(chr), drop=1.5)
result2 <- rbind(result2, lodint.result)
}
out[[i]] <- result2
result2 <- NULL
}, error=function(e){cat("ERROR:", conditionMessage(e), "\n")})
}
out <- lapply(out, as.data.frame)
colnames <- c("chr", "pos", "LOD_trait", "info", "LOD*info")
out <- lapply(out, function(x) {
tryCatch({setNames(x, colnames)},
error=function(e){cat("ERROR:", conditionMessage(e), "\n")})
})
do.call(rbind, lapply(out, as.data.frame))
do.call(rbind, lapply(out, function(x){data.frame(id=x, eval(parse(text=x)))}))
